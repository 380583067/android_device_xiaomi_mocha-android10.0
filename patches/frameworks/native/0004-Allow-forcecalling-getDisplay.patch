From 934cabcce19c5d7caea913dd0a4868309f4ed692 Mon Sep 17 00:00:00 2001
From: bilux <i.bilux@gmail.com>
Date: Mon, 23 Mar 2020 09:39:03 +0100
Subject: [PATCH] Allow forcecalling getDisplay

as of https://github.com/HighwayStar/android_device_xiaomi_mocha/issues/3
mocha requires forcecalling getDisplay to work

Signed-off-by: bilux <i.bilux@gmail.com>
---
 opengl/libs/EGL/egl_display.cpp | 1 +
 1 file changed, 1 insertion(+)

diff --git a/opengl/libs/EGL/egl_display.cpp b/opengl/libs/EGL/egl_display.cpp
index 2aec249..5f8092f 100644
--- a/opengl/libs/EGL/egl_display.cpp
+++ b/opengl/libs/EGL/egl_display.cpp
@@ -175,6 +175,7 @@ EGLBoolean egl_display_t::initialize(EGLint *major, EGLint *minor) {
         cnx->major = -1;
         cnx->minor = -1;
         if (cnx->dso) {
+            disp.dpy = cnx->egl.eglGetDisplay(EGL_DEFAULT_DISPLAY);
             EGLDisplay idpy = disp.dpy;
             if (cnx->egl.eglInitialize(idpy, &cnx->major, &cnx->minor)) {
                 //ALOGD("initialized dpy=%p, ver=%d.%d, cnx=%p",
-- 
2.25.1

